<h1 class="mb-4">Order Review</h1>

<div class="row">
  <!-- Customer / Shipping Info -->
  <div class="col-md-6 mb-4">
    <h3>Shipping & Billing Information</h3>
    <ul class="list-group">
      <li class="list-group-item"><strong>Name:</strong> <%= @order_data["full_name"] %></li>
      <li class="list-group-item"><strong>Email:</strong> <%= @order_data["email"] if @order_data["email"].present? %></li>
      <li class="list-group-item"><strong>Address:</strong> <%= @order_data["address"] %></li>
      <li class="list-group-item"><strong>City:</strong> <%= @order_data["city"] %></li>
      <li class="list-group-item"><strong>Postal Code:</strong> <%= @order_data["postal"] %></li>
      <li class="list-group-item"><strong>Province:</strong> <%= @province&.name %></li>
    </ul>
    <%= link_to "Edit Address", checkout_address_path, class: "btn btn-secondary mt-3" %>
  </div>

  <!-- Cart Items -->
  <div class="col-md-6 mb-4">
    <h3>Cart Items</h3>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Product</th>
          <th>Price</th>
          <th>Qty</th>
          <th>Line Total</th>
        </tr>
      </thead>
      <tbody>
        <% @cart_items.each do |item| %>
          <tr>
            <td><%= item[:product].name %></td>
            <td>$<%= '%.2f' % item[:product].price %></td>
            <td><%= item[:quantity] %></td>
            <td>$<%= '%.2f' % (item[:product].price * item[:quantity]) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <h4>Summary</h4>
    <ul class="list-group mb-3">
      <li class="list-group-item d-flex justify-content-between">
        <span>Subtotal:</span>
        <span>$<%= '%.2f' % (@subtotal_cents.to_f / 100) %></span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>GST:</span>
        <span>$<%= '%.2f' % (@gst_cents.to_f / 100) %></span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>PST:</span>
        <span>$<%= '%.2f' % (@pst_cents.to_f / 100) %></span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>HST:</span>
        <span>$<%= '%.2f' % (@hst_cents.to_f / 100) %></span>
      </li>
      <li class="list-group-item d-flex justify-content-between fw-bold">
        <span>Total:</span>
        <span>$<%= '%.2f' % (@total_cents.to_f / 100) %></span>
      </li>
    </ul>

    <%= button_to "Place Order", checkout_create_path, method: :post, class: "btn btn-success btn-lg w-100" %>
  </div>
</div>
