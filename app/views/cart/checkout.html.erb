<h1>Checkout</h1>

<%= form_with url: place_order_cart_path, method: :post do %>
  <h3>Customer Information</h3>

  <div class="mb-3">
    <%= label_tag "customer[name]", "Full Name" %>
    <%= text_field_tag "customer[name]", "", class: "form-control", required: true %>
  </div>

  <div class="mb-3">
    <%= label_tag "customer[email]", "Email" %>
    <%= email_field_tag "customer[email]", "", class: "form-control", required: true %>
  </div>

  <div class="mb-3">
    <%= label_tag "customer[province]", "Province" %>
    <%= select_tag "customer[province]",
          options_for_select([ "ON", "BC", "AB", "Other" ]),
          class: "form-control", required: true %>
  </div>

  <div class="mb-3">
    <%= label_tag "customer[address]", "Address (optional)" %>
    <%= text_field_tag "customer[address]", "", class: "form-control" %>
  </div>

  <h3>Order Summary</h3>
  <table class="table">
    <thead>
      <tr>
        <th>Product</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Line Total</th>
      </tr>
    </thead>
    <tbody>
      <% @items.each do |it| %>
        <tr>
          <td><%= it.product.name %></td>
          <td>$<%= '%.2f' % it.product.price %></td>
          <td><%= it.quantity %></td>
          <td>$<%= '%.2f' % (it.product.price * it.quantity) %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <p><strong>Subtotal:</strong> $<%= '%.2f' % @subtotal %></p>

  <%= submit_tag "Place Order", class: "btn btn-primary" %>
<% end %>
