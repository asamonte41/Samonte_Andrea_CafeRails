<h1>Checkout</h1>

<%= form_with model: @customer,
              url: place_order_cart_index_path,
              method: :post,
              local: true do |f| %>

  <% if flash[:alert] %>
    <div class="alert alert-danger"><%= flash[:alert] %></div>
  <% end %>

  <h3>Customer Information</h3>

  <div class="mb-3">
    <%= f.label :full_name %>
    <%= f.text_field :full_name, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :email %>
    <%= f.email_field :email, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :address %>
    <%= f.text_field :address, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :city %>
    <%= f.text_field :city, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :postal %>
    <%= f.text_field :postal, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= f.label :province_code, "Province" %>
    <%= f.select :province_code,
                Province.all.map { |p| [p.name, p.code] },
                {},
                class: "form-control" %>
  </div>

  <hr>

  <h3>Order Summary</h3>

  <ul>
    <% @items.each do |item| %>
      <li><%= item.product.name %> (x<%= item.quantity %>) â€“ <%= number_to_currency(item.product.price * item.quantity) %></li>
    <% end %>
  </ul>

  <p><strong>Subtotal:</strong> <%= number_to_currency(@subtotal) %></p>

  <%= f.submit "Place Order", class: "btn btn-success" %>

<% end %>
